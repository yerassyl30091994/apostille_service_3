angular.module("app").directive('amountField', ['$filter', function($filter) {
    return {
        replace: true,
        restrict: 'E',
        require: ['ngModel'],
        templateUrl: "kit/directives/amount-field/amount-field.html",
        link: function(scope, element, attrs, ctrls){
            scope.amountvalue = 0;
            scope.$watch('amountvalue', function(newValue,oldValue) {
                var value = String(newValue).split(".");
                var integral = value[0];
                var fractional = value[1] || [];
                if (value.length === 0) return;
                if (isNaN(newValue) || fractional.length > 2) {
                    scope.amountvalue = oldValue;
                } else{
                    ctrls[0].$setViewValue(scope.amountvalue);
                }
                
            });

        }

    }
}]);