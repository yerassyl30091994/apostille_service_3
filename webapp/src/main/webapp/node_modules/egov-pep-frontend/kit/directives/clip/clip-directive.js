angular.module("app").directive('clip', ["$q", "$timeout", function ($q, $timeout) {

    return {
        scope: true,
        replace: false,
        restrict: "A",
        require: '^clipbox',
        link: function (scope, elem, attrs, ctr) {
            var clipId = ctr.clip(elem);
            scope.$on('$destroy', function(){
                ctr.unclip(clipId);
            });
        }
    }
}]);